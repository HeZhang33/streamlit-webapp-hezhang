this is modified by he zhang
